{"version":3,"file":"main.js","sources":["../src/SlidePanel.ts"],"sourcesContent":["import styleSheet from \"./style.css\";\nimport template from \"./template.html\";\n\nconst slidePanelTemplate = document.createElement(\"template\");\n\nslidePanelTemplate.innerHTML = `\n  <style>\n    ${styleSheet}</style>\n  ${template}\n  `\n\nconst slidePanelOpen = new CustomEvent(\"slide-panel-open\", {\n  bubbles: true\n});\n\nconst slidePanelClose = new CustomEvent(\"slide-panel-close\", {\n  bubbles: true\n});\nclass SlidePanel extends HTMLElement {\n  private _shadowRoot: ShadowRoot;\n\n  private timeoutId: number;\n\n  [key: string]: any;\n\n  constructor() {\n    super();\n\n    this._shadowRoot = this.attachShadow({ mode: \"open\" });\n\n    this._shadowRoot.appendChild(slidePanelTemplate.content.cloneNode(true));\n\n    this.timeoutId = 0;\n\n    this.updateTransitionDuration(this.transitionDuration);  \n  \n  }\n\n  connectedCallback() {\n    this.attachEventListeners();\n    if (this.position) {\n      this.setAnchorClass(this.position);\n    } else {\n      this.setAnchorClass()\n    }\n\n    if (this.transitionDuration) {\n      this.updateTransitionDuration(this.transitionDuration)\n    }\n\n    this._upgradeProperty(\"open\");\n    this._upgradeProperty(\"transitionDuration\");\n    this._upgradeProperty(\"position\");\n\n    if (!this.open) {\n      this.hideRoot();\n      this.hideBackdrop();\n      this.hidePanel();\n    }\n  }\n\n  getRoot() {\n    return this._shadowRoot.querySelector<HTMLElement>(\".slide-panel\");\n  }\n\n  getBackdrop() {\n    return this._shadowRoot.querySelector<HTMLElement>(\".slide-panel__backdrop\");\n  };\n\n  hideBackdrop() {\n    const backdrop = this.getBackdrop();\n    if (backdrop) {\n      backdrop.style.visibility = \"hidden\";\n    }\n  }\n\n  showBackdrop() {\n    const backdrop = this.getBackdrop();\n    if (backdrop) {\n      backdrop.style.opacity = \"1\";\n      backdrop.style.removeProperty(\"visibility\");\n    }\n  }\n\n  hideRoot() {\n    const root = this.getRoot();\n    root?.setAttribute(\"aria-hidden\", \"true\");\n    if (root) {\n      clearTimeout(this.timeoutId);\n      this.timeoutId = setTimeout(() => {\n        root.style.visibility = \"hidden\";\n      }, parseInt(this.transitionDuration))\n    }\n  }\n  \n  showRoot() {\n    const root = this.getRoot();\n    root?.setAttribute(\"aria-hidden\", \"false\");\n    if (root) {\n      root.style.removeProperty(\"visibility\");\n    }\n  }\n\n  hidePanel() {\n    const panel = this.getPanel();\n    if (panel) {\n      panel.style.removeProperty(\"transform\");\n      clearTimeout(this.timeoutId);\n      this.timeoutId = setTimeout(() => {\n        panel.style.visibility = \"hidden\";\n      }, parseInt(this.transitionDuration));\n    }\n  }\n\n  _upgradeProperty(prop: string) {\n  if (this.hasOwnProperty(prop)) {\n    let value = this[prop];\n    delete this[prop];\n    this[prop] = value;\n  }\n}\n\n  static get observedAttributes() {\n    return [\"open\", \"position\", \"transitionDuration\"];\n  }\n\n  attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (oldVal === newVal) {\n      return;\n    }\n\n    if (attrName === \"open\" && oldVal !== newVal) {\n      if (newVal !== null) {\n        this.showRoot();\n        this.showBackdrop();\n        this.showPanel();\n        this.attachEventListeners();\n\n        this.dispatchEvent(slidePanelOpen);\n      } else {\n        this.hideRoot();\n        this.hideBackdrop();\n        this.hidePanel();\n\n        this.dispatchEvent(slidePanelClose);\n\n        document.removeEventListener(\"keydown\", this._handleKeyDown.bind(this));\n      }\n    }\n\n    if (attrName === \"position\") {\n      this.removeAnchorClass(oldVal);\n      this.setAnchorClass(newVal);\n    }\n\n    if (attrName === \"transitionDuration\") {\n      if (oldVal !== newVal) {\n        this.updateTransitionDuration(newVal);\n      }\n    }\n\n    if (attrName === \"handleClose\") {\n      console.log(this.handleClose)\n    }\n  }\n\n  getAnchorClass(position: string) {\n    let className = \"slide-panel__panel\";\n    switch (position) {\n      case \"left\":\n        className += \"--left\";\n        break;\n      case \"right\":\n        className += \"--right\";\n        break;\n      case \"top\":\n        className += \"--top\";\n        break;\n      case \"bottom\":\n        className += \"--bottom\";\n        break;\n      default:\n        className += \"--left\";\n    }\n\n    return className;\n  }\n\n  removeAnchorClass(position: string) {\n    const className = this.getAnchorClass(position);\n    const panel = this.getPanel();\n    panel?.classList.remove(className);\n  }\n\n  setAnchorClass(position: string = \"left\") {\n    const className = this.getAnchorClass(position);\n    const panel = this.getPanel();\n    panel?.classList.add(className);\n  }\n\n  get open() {\n    return this.hasAttribute(\"open\");\n  }\n\n  set open(value) {\n    const isOpen = Boolean(value);\n    if (isOpen) {\n      this.setAttribute(\"open\", \"\");\n    } else {\n      this.removeAttribute(\"open\");\n    }\n  }\n\n  get position() {\n    return this.getAttribute(\"position\");\n  }\n\n  set position(value) {\n    this.position = value;\n  }\n\n  get transitionDuration() {\n    return this.getAttribute(\"transitionDuration\") || \"300\";\n  }\n\n  set transitionDuration(value) {\n    if (value) {\n      this.transitionDuration = value;\n    }\n  }\n\n  get handleClose() {\n    return this.getAttribute(\"handleClose\")\n  }\n\n  set handleClose(value) {\n    this.handleClose = value;\n  }\n\n  attachEventListeners() {\n    const backdrop = this.getBackdrop();\n    backdrop?.addEventListener(\"click\", () => {\n       this._handleBackdropClick();\n    })\n\n    document.addEventListener(\"keydown\", this._handleKeyDown.bind(this));\n  }\n\n  getPanel() {\n    return this._shadowRoot.querySelector<HTMLElement>('.slide-panel__panel');\n  }\n\n  showPanel() {\n    const panel = this.getPanel();\n    if (panel) {\n      panel.style.removeProperty(\"visibility\");\n    }\n  }\n\n  updateTransitionDuration(transitionDuration: string) {\n    const style = this._shadowRoot.querySelector(\"style\");\n    if (style) {\n      style.textContent = `\n      :host {\n        transition-duration: ${transitionDuration}ms;\n      }\n      ${styleSheet}\n    `\n    }\n\n    const backdrop = this.getBackdrop();\n    if (backdrop) {\n      backdrop.style.transitionDuration = this.transitionDuration + \"ms\";\n    }\n\n    const panel = this.getPanel();\n    if (panel) {\n      panel.style.transitionDuration = this.transitionDuration + \"ms\";\n    }\n  }\n\n  private _handleKeyDown(event: KeyboardEvent) {\n    event.preventDefault();\n    if (event.key === \"Escape\") {\n      this.open = false;\n    }\n  }\n\n  private _handleBackdropClick() {\n    this.open = false;\n  }\n}\n\nwindow.customElements.define(\"slide-panel\", SlidePanel);\n\ndeclare global {\n  namespace JSX {\n    interface IntrinsicElements {\n      \"slide-panel\": any;\n    }\n  }\n}"],"names":["styleSheet"],"mappings":"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"}