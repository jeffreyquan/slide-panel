{"version":3,"file":"slide-panel.min.js","sources":["../src/SlidePanel.ts"],"sourcesContent":["import styleSheet from \"./style.css\";\nimport template from \"./template.html\";\n\nconst slidePanelTemplate = document.createElement(\"template\");\n\nslidePanelTemplate.innerHTML = `\n  <style>\n    ${styleSheet}</style>\n  ${template}\n  `\n\nconst slidePanelOpen = new CustomEvent(\"slide-panel-open\", {\n  bubbles: true\n});\n\nconst slidePanelClose = new CustomEvent(\"slide-panel-close\", {\n  bubbles: true\n});\nclass SlidePanel extends HTMLElement {\n  private _shadowRoot: ShadowRoot;\n\n  private timeoutId: number;\n\n  [key: string]: any;\n\n  constructor() {\n    super();\n\n    this._shadowRoot = this.attachShadow({ mode: \"open\" });\n\n    this._shadowRoot.appendChild(slidePanelTemplate.content.cloneNode(true));\n\n    this.timeoutId = 0;\n\n    this.updateTransitionDuration(this.transitionDuration);  \n  }\n\n  connectedCallback() {\n    this.attachEventListeners();\n\n    if (this.position) {\n      this.setAnchorClass(this.position);\n    } else {\n      this.setAnchorClass()\n    }\n\n    if (this.transitionDuration) {\n      this.updateTransitionDuration(this.transitionDuration)\n    }\n\n    this._upgradeProperty(\"open\");\n    this._upgradeProperty(\"transitionDuration\");\n    this._upgradeProperty(\"position\");\n\n    if (!this.open) {\n      this.hideRoot();\n      this.hideBackdrop();\n      this.hidePanel();\n    }\n  }\n\n  getRoot() {\n    return this._shadowRoot.querySelector<HTMLElement>(\".slide-panel\");\n  }\n\n  getBackdrop() {\n    return this._shadowRoot.querySelector<HTMLElement>(\".slide-panel__backdrop\");\n  };\n\n  hideBackdrop() {\n    const backdrop = this.getBackdrop();\n    if (backdrop) {\n      backdrop.style.visibility = \"hidden\";\n    }\n  }\n\n  showBackdrop() {\n    const backdrop = this.getBackdrop();\n    if (backdrop) {\n      backdrop.style.opacity = \"1\";\n      backdrop.style.removeProperty(\"visibility\");\n    }\n  }\n\n  hideRoot() {\n    const root = this.getRoot();\n    root?.setAttribute(\"aria-hidden\", \"true\");\n    if (root) {\n      clearTimeout(this.timeoutId);\n      this.timeoutId = window.setTimeout(() => {\n        root.style.visibility = \"hidden\";\n      }, parseInt(this.transitionDuration))\n    }\n  }\n  \n  showRoot() {\n    const root = this.getRoot();\n    root?.setAttribute(\"aria-hidden\", \"false\");\n    if (root) {\n      root.style.removeProperty(\"visibility\");\n    }\n  }\n\n  hidePanel() {\n    const panel = this.getPanel();\n    if (panel) {\n      panel.style.removeProperty(\"transform\");\n      clearTimeout(this.timeoutId);\n      this.timeoutId = window.setTimeout(() => {\n        panel.style.visibility = \"hidden\";\n      }, parseInt(this.transitionDuration));\n    }\n  }\n\n  _upgradeProperty(prop: string) {\n    if (this.hasOwnProperty(prop)) {\n      let value = this[prop];\n      delete this[prop];\n      this[prop] = value;\n    }\n  }\n\n  static get observedAttributes() {\n    return [\"open\", \"position\", \"transitionDuration\"];\n  }\n\n  attributeChangedCallback(attrName: string, oldVal: string, newVal: string) {\n    if (oldVal === newVal) {\n      return;\n    }\n\n    if (attrName === \"open\") {\n      if (newVal === \"\" || newVal === \"true\") {\n        this.showRoot();\n        this.showBackdrop();\n        this.showPanel();\n        this.attachEventListeners();\n\n        this.dispatchEvent(slidePanelOpen);\n      } else {\n        this.hideRoot();\n        this.hideBackdrop();\n        this.hidePanel();\n\n        this.dispatchEvent(slidePanelClose);\n\n        document.removeEventListener(\"keydown\", this._handleKeyDown.bind(this));\n      }\n    }\n\n    if (attrName === \"position\") {\n      this.removeAnchorClass(oldVal);\n      this.setAnchorClass(newVal);\n    }\n\n    if (attrName === \"transitionDuration\") {\n      this.updateTransitionDuration(newVal);\n    }\n  }\n\n  getAnchorClass(position: string) {\n    let className = \"slide-panel__panel\";\n    switch (position) {\n      case \"left\":\n        className += \"--left\";\n        break;\n      case \"right\":\n        className += \"--right\";\n        break;\n      case \"top\":\n        className += \"--top\";\n        break;\n      case \"bottom\":\n        className += \"--bottom\";\n        break;\n      default:\n        className += \"--left\";\n    }\n\n    return className;\n  }\n\n  removeAnchorClass(position: string) {\n    const className = this.getAnchorClass(position);\n    const panel = this.getPanel();\n    panel?.classList.remove(className);\n  }\n\n  setAnchorClass(position: string = \"left\") {\n    const className = this.getAnchorClass(position);\n    const panel = this.getPanel();\n    panel?.classList.add(className);\n  }\n\n  get open() {\n    return Boolean(this.getAttribute(\"open\"));\n  }\n\n  set open(value) {\n    const isOpen = Boolean(value);\n    if (isOpen) {\n      this.setAttribute(\"open\", \"true\");\n    } else {\n      this.setAttribute(\"open\", \"false\");\n    }\n  }\n\n  get position() {\n    return this.getAttribute(\"position\");\n  }\n\n  set position(value) {\n    this.position = value;\n  }\n\n  get transitionDuration() {\n    return this.getAttribute(\"transitionDuration\") || \"300\";\n  }\n\n  set transitionDuration(value) {\n    if (value) {\n      this.transitionDuration = value;\n    }\n  }\n\n  get handleClose() {\n    return this.getAttribute(\"handleClose\")\n  }\n\n  set handleClose(value) {\n    this.handleClose = value;\n  }\n\n  attachEventListeners() {\n    const backdrop = this.getBackdrop();\n    backdrop?.addEventListener(\"click\", () => {\n       this._handleBackdropClick();\n    })\n\n    document.addEventListener(\"keydown\", this._handleKeyDown.bind(this));\n  }\n\n  getPanel() {\n    return this._shadowRoot.querySelector<HTMLElement>('.slide-panel__panel');\n  }\n\n  showPanel() {\n    const panel = this.getPanel();\n    if (panel) {\n      panel.style.removeProperty(\"visibility\");\n    }\n  }\n\n  updateTransitionDuration(transitionDuration: string) {\n    const style = this._shadowRoot.querySelector(\"style\");\n    if (style) {\n      style.textContent = `\n      :host {\n        transition-duration: ${transitionDuration}ms;\n      }\n      ${styleSheet}\n    `\n    }\n\n    const backdrop = this.getBackdrop();\n    if (backdrop) {\n      backdrop.style.transitionDuration = this.transitionDuration + \"ms\";\n    }\n\n    const panel = this.getPanel();\n    if (panel) {\n      panel.style.transitionDuration = this.transitionDuration + \"ms\";\n    }\n  }\n\n  private _handleKeyDown(event: KeyboardEvent) {\n    event.preventDefault();\n    if (event.key === \"Escape\") {\n      this.open = false;\n    }\n  }\n\n  private _handleBackdropClick() {\n    this.open = false;\n  }\n}\n\nwindow.customElements.define(\"slide-panel\", SlidePanel);\n\ndeclare global {\n  namespace JSX {\n    interface IntrinsicElements {\n      \"slide-panel\": any;\n    }\n  }\n}"],"names":["slidePanelTemplate","document","createElement","innerHTML","styleSheet","slidePanelOpen","CustomEvent","bubbles","slidePanelClose","SlidePanel","HTMLElement","[object Object]","super","this","_shadowRoot","attachShadow","mode","appendChild","content","cloneNode","timeoutId","updateTransitionDuration","transitionDuration","attachEventListeners","position","setAnchorClass","_upgradeProperty","open","hideRoot","hideBackdrop","hidePanel","querySelector","backdrop","getBackdrop","style","visibility","opacity","removeProperty","root","getRoot","setAttribute","clearTimeout","window","setTimeout","parseInt","panel","getPanel","prop","hasOwnProperty","value","observedAttributes","attrName","oldVal","newVal","showRoot","showBackdrop","showPanel","dispatchEvent","removeEventListener","_handleKeyDown","bind","removeAnchorClass","className","getAnchorClass","classList","remove","add","Boolean","getAttribute","handleClose","addEventListener","_handleBackdropClick","textContent","event","preventDefault","key","customElements","define"],"mappings":"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"}